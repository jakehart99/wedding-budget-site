<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wedding Budget Item</title>
    <link rel="stylesheet" href="css/style.css" />
    <!-- Supabase client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Supabase configuration -->
    <script>
      const SUPABASE_URL = 'https://ngatfywxrhkuqcbiewsb.supabase.co';
      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nYXRmeXd4cmhrdXFjYmlld3NiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA5ODgyNDEsImV4cCI6MjA3NjU2NDI0MX0.i2iOQZEBlDNyc0IpUNeCHNgLDB4vARqTv_keP7jS3tM';
    </script>
    <!-- Include the open‑source marked library for Markdown parsing -->
    <script defer src="js/marked.min.js?v=2"></script>
    <script defer src="js/item.js"></script>
  </head>
  <body>
    <header>
      <div class="header-content">
        <h1 id="pageTitle">Item Details</h1>
        <div class="header-actions">
          <button id="editBtn" class="btn-edit" style="display: none;">Edit Markdown</button>
          <button id="printBtn" class="btn-secondary" style="display: none;">Print</button>
          <button id="saveBtn" class="btn-primary" style="display: none;">Save</button>
          <button id="cancelBtn" class="btn-secondary" style="display: none;">Cancel</button>
        </div>
      </div>
    </header>
    <main>
      <!-- Breadcrumb Navigation -->
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="index.html" class="back-link">← Back to Budget List</a>
      </nav>

      <!-- View Mode (default) -->
      <div id="viewMode">
        <!-- Item Hero Section -->
        <section class="item-hero">
          <h1 id="itemTitle" class="item-name">Loading...</h1>
          <div class="item-badges">
            <span id="categoryBadge" class="badge badge-category"></span>
            <span id="requiredBadge" class="badge badge-required"></span>
          </div>
        </section>

        <!-- Metadata Card -->
        <section class="metadata-card">
          <h2 class="metadata-title">Budget Details</h2>
          <div class="metadata-grid">
            <div class="metadata-item">
              <span class="metadata-label">Unit Cost</span>
              <span id="metaUnitCost" class="metadata-value">—</span>
            </div>
            <div class="metadata-item">
              <span class="metadata-label">Quantity</span>
              <span id="metaQuantity" class="metadata-value">—</span>
            </div>
            <div class="metadata-item">
              <span class="metadata-label">Subtotal</span>
              <span id="metaSubtotal" class="metadata-value metadata-value-highlight">—</span>
            </div>
          </div>
          <div class="metadata-footer">
            <small id="metaTimestamps" class="metadata-timestamps"></small>
          </div>
        </section>

        <!-- Content Layout with TOC and Article -->
        <div class="content-layout">
          <!-- Table of Contents (auto-generated by JS) -->
          <nav id="tableOfContents" class="toc" aria-label="Table of contents" style="display: none;">
            <h3 class="toc-title">Contents</h3>
            <ul id="tocList" class="toc-list"></ul>
          </nav>

          <!-- Article Body -->
          <article class="article-body">
            <div class="markdown-content" id="markdownContent"></div>
          </article>
        </div>
      </div>

      <!-- Edit Mode (hidden by default) -->
      <div id="editMode" style="display: none;">
        <div class="markdown-editor">
          <div class="editor-layout">
            <div class="editor-pane">
              <label for="mdTextarea">Markdown Source</label>
              <textarea id="mdTextarea" rows="20" placeholder="Enter markdown content..."></textarea>
              <small class="editor-help">Use Markdown formatting: **bold**, *italic*, [links](url), # headings, etc.</small>
            </div>
            <div class="preview-pane">
              <label>Live Preview</label>
              <article class="markdown-content" id="livePreview"></article>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer>
      <p>&copy; 2025 Wedding Planner</p>
    </footer>
  </body>
</html>